package com.example.qr;

import androidx.appcompat.app.AppCompatActivity;

import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

public class Exploitation extends AppCompatActivity {

    TextView invId;
    TextView invType;
    TextView invName;
    TextView invNumber;
    TextView invNumberClass;
    TextView invTypeClass;

    Button explBtn;

    Asset asset;
// После изменения класса и отправки текста на сервер, на той стороне должна проходить обработка данных
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.into_exploitation);

        //Main information
        invName=(TextView)findViewById(R.id.nameInvInfo);
        invNumberClass=(TextView)findViewById(R.id.multiAutoCompleteTextView);
        //Buttons
        explBtn=(Button)findViewById(R.id.intoExplBtn);

        asset = getIntent().getParcelableExtra("compNumber");

        invName.setText(asset.getName());
        invNumberClass.setText(asset.getNumberClass());

        explBtn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                new ServerGetInfo();
            }
        });
    }

    public class ServerGetInfo extends AsyncTask<String, String, String> {
        boolean answerHTTP=false; // Ответ от сервера
        Asset takenInventory; // Объект инвентарь
        int answer;

        @Override
        protected void onPreExecute() {
            super.onPreExecute();

        }

        @Override
        protected String doInBackground(String... params) {/*
            ServerMethods connection = new ServerMethods("http://qrcodemosit.000webhostapp.com/intoExploitation.php");
            answer = connection.IntoExploitation(asset.getId().toString(), invNumberClass.getText().toString());
            if (answer == 1) {
                takenInventory = connection.inventory; //полученный инвентарь
                answerHTTP = true;
            }*/
            return null;
        }

        @Override
        protected void onPostExecute(String result) {
            super.onPostExecute(result);
            if(answer==1){
                Toast.makeText(getApplicationContext(), "Изменение прошло успешно.", Toast.LENGTH_SHORT).show();
                finish();
            }
            else
                Toast.makeText(getApplicationContext(), "Произошла проблема с отправкой данных, повторите попытку позднее", Toast.LENGTH_SHORT).show();
        }
    }
}
